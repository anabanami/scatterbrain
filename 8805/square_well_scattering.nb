(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     31676,        772]
NotebookOptionsPosition[     26448,        690]
NotebookOutlinePosition[     26990,        710]
CellTagsIndexPosition[     26947,        707]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Scattering from a Spherical Square Well", "Title"]], \
"Subtitle",
 CellChangeTimes->{{3.5789917721988163`*^9, 3.578991784649598*^9}},
 TextAlignment->Center,
 TextJustification->0,ExpressionUUID->"0f2b73d7-1789-450c-b37a-11c5f36982fc"],

Cell[CellGroupData[{

Cell["Preliminaries", "Section",
 CellChangeTimes->{{3.578992161892858*^9, 3.5789921673167067`*^9}, {
  3.578992899535861*^9, 
  3.5789929065819273`*^9}},ExpressionUUID->"e4f60c0f-18fd-4860-b031-\
e4b10c42ac1c"],

Cell["\<\
In this notebook, we compute the phase shifts of the potential with V = -V0 \
for r<R and V=0 for r>R with an analytic formula and using the Variable Phase \
Approach (VPA). The reduced mass is \[Mu].\
\>", "Text",
 CellChangeTimes->{{3.578991804189644*^9, 
  3.578991896814013*^9}},ExpressionUUID->"c6cfd9f4-0fec-4f5f-9607-\
1896a38c4dae"],

Cell["\<\
Work in units where \[HBar]=1 and we measure mass in units of \[Mu] and \
lengths in terms of R.  Thus we set \[Mu] and R to 1. However, we will \
continue to make them explicit in the formulas.\
\>", "Text",
 CellChangeTimes->{{3.578991905906199*^9, 
  3.5789920613401957`*^9}},ExpressionUUID->"030600d9-350e-4282-a0b3-\
c7f1e0abeb2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]", " ", "=", " ", "1"}], ";", " ", 
  RowBox[{"R", "=", "1."}], ";"}]], "Input",
 CellChangeTimes->{{3.5789594635175257`*^9, 3.578959474759516*^9}, {
  3.578960179079566*^9, 3.578960180672069*^9}, {3.578960284597147*^9, 
  3.578960291575789*^9}, {3.5789883511098747`*^9, 3.578988353326708*^9}, {
  3.578992020177764*^9, 3.578992026252306*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"f9bd32a8-9d75-4edf-8342-444907931f5f"],

Cell["The only parameter to adjust now is the depth V0.", "Text",
 CellChangeTimes->{{3.578992033285995*^9, 
  3.578992072167925*^9}},ExpressionUUID->"9640d5cd-e40c-4bcf-9357-\
956833a9214f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vsw", "[", 
   RowBox[{"r_", ",", "V0_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"-", "V0"}], " ", 
   RowBox[{"HeavisideTheta", "[", 
    RowBox[{"R", "-", "r"}], "]"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"Define", " ", "the", " ", "square", " ", "well"}], " ", 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.578960476927094*^9, 3.5789604854430857`*^9}, 
   3.5789605656171083`*^9, {3.5789886930244207`*^9, 3.578988696136908*^9}, {
   3.578992857563777*^9, 3.578992873761244*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"152dc746-d8a8-42a1-a3bf-6b0418633a92"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Vsw", "[", 
     RowBox[{"r", ",", "5"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "0", ",", "4"}], "}"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}]}], "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Uncomment", " ", "to", " ", "check", " ", "potential"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.578960567351787*^9, 3.578960577113687*^9}, {
  3.5789876970863*^9, 3.578987700518033*^9}, {3.5789934615811243`*^9, 
  3.578993524017034*^9}, {3.579002475247075*^9, 3.57900248579283*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"65388054-f72b-44b0-9a58-b8de24e1608b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ek", "[", "k_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"k", "^", "2"}], "/", 
   RowBox[{"(", 
    RowBox[{"2", "\[Mu]"}], ")"}], "   ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Convenient", " ", "definition", " ", "of", " ", "kinetic", " ", 
     "energy"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.578960129640374*^9, 3.5789601399502563`*^9}, {
  3.57899210878828*^9, 3.5789921150698347`*^9}, {3.578992238020005*^9, 
  3.578992251253972*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"b09e17e1-8761-431f-b7aa-73b58416000c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analytic result for the phase shift", "Section",
 CellChangeTimes->{{3.578992161892858*^9, 
  3.5789921673167067`*^9}},ExpressionUUID->"fb51d75e-a512-41f2-8c52-\
fab6ad85fe71"],

Cell["\<\
Use the formula for \[Delta](E) from one of the problems, converting it to \
\[Delta](k) using Ek(k):\
\>", "Text",
 CellChangeTimes->{{3.5789922901147614`*^9, 3.578992318170765*^9}, {
  3.579163313578528*^9, 
  3.579163332937916*^9}},ExpressionUUID->"763f5ee2-bc77-48cb-961e-\
42581e01bc16"],

Cell[BoxData[
 RowBox[{
  RowBox[{"deltaAnalytic", "[", 
   RowBox[{"k_", ",", "V0_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"ArcTan", "[", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"Ek", "[", "k", "]"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Ek", "[", "k", "]"}], "+", "V0"}], ")"}]}], "]"}], " ", 
     RowBox[{"Tan", "[", 
      RowBox[{"R", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2", "\[Mu]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Ek", "[", "k", "]"}], "+", "V0"}], ")"}]}], "]"}]}], 
      "]"}]}], "]"}], "-", 
   RowBox[{"R", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"2", " ", "\[Mu]", " ", 
      RowBox[{"Ek", "[", "k", "]"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.578960156468554*^9, 3.578960252677409*^9}, {
  3.578992262485491*^9, 3.578992280068061*^9}, {3.578992325937764*^9, 
  3.578992347220014*^9}, {3.578992472192412*^9, 3.578992473539826*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"07f7602f-044d-4f91-b793-a7a03262485f"],

Cell[TextData[{
 "Use Cell->Convert  to->TraditionalForm to get it in a form easier to check \
we have entered it correctly:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"deltaAnalytic", "(", 
     RowBox[{"k_", ",", "V0_"}], ")"}], ":=", 
    RowBox[{
     RowBox[{
      SuperscriptBox["tan", 
       RowBox[{"-", "1"}]], "(", 
      RowBox[{
       SqrtBox[
        FractionBox[
         RowBox[{"Ek", "(", "k", ")"}], 
         RowBox[{
          RowBox[{"Ek", "(", "k", ")"}], "+", "V0"}]]], " ", 
       RowBox[{"tan", "(", 
        RowBox[{"R", " ", 
         SqrtBox[
          RowBox[{"2", " ", "\[Mu]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Ek", "(", "k", ")"}], "+", "V0"}], ")"}]}]]}], ")"}]}], 
      ")"}], "-", 
     RowBox[{"R", " ", 
      SqrtBox[
       RowBox[{"2", " ", "\[Mu]", " ", 
        RowBox[{"Ek", "(", "k", ")"}]}]]}]}]}], TraditionalForm]], "Text",
  CellChangeTimes->{{3.578960156468554*^9, 3.578960252677409*^9}, {
   3.578992262485491*^9, 3.578992280068061*^9}, {3.578992325937764*^9, 
   3.5789923728313217`*^9}, {3.579163235490621*^9, 3.579163250926553*^9}},
  ExpressionUUID->"cbf5b62c-07c8-4281-9432-64ed530efc9c"]
}], "Text",
 CellChangeTimes->{{3.578992385989189*^9, 3.578992416529379*^9}, {
  3.5791632643927794`*^9, 
  3.5791632846526613`*^9}},ExpressionUUID->"bb004ca7-c445-4630-a22a-\
78a55657405b"],

Cell["Always check that the function actually produces a number.", "Text",
 CellChangeTimes->{{3.578992486490327*^9, 
  3.578992500352096*^9}},ExpressionUUID->"f86a06c7-17c0-4357-a700-\
2bae4f5cac10"],

Cell[BoxData[
 RowBox[{"deltaAnalytic", "[", 
  RowBox[{"5", ",", "0.5"}], "]"}]], "Input",
 CellChangeTimes->{{3.578960258785399*^9, 3.578960265725395*^9}, {
  3.5789891657659492`*^9, 3.578989165938911*^9}, {3.5789924569677677`*^9, 
  3.578992478327364*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"e25cbfe7-ec3f-4d95-b5b2-674205f715cb"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"deltaAnalytic", "[", 
    RowBox[{"k", ",", "0.5"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.578960298716509*^9, 3.578960307992738*^9}, {
  3.5789891819172897`*^9, 3.578989184912376*^9}, {3.5789925127956944`*^9, 
  3.578992523997209*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"6a33db37-a692-4957-94a4-83a0b2191795"],

Cell["\<\
What is going on with the steps?  Why are they there?  Is the phase shift \
really discontinuous?  How would you fix it?\
\>", "Text",
 CellChangeTimes->{{3.578987782524703*^9, 
  3.578987815194057*^9}},ExpressionUUID->"d76f4987-d012-40e5-8665-\
31012bd093a1"],

Cell["\<\
Here is one \[OpenCurlyDoubleQuote]fix\[CloseCurlyDoubleQuote] that makes the \
result continuous for this example, but we will still have issues when V0 is \
large enough to support bound states.\
\>", "Text",
 CellChangeTimes->{{3.578992557677102*^9, 
  3.578992620072345*^9}},ExpressionUUID->"f376493a-05bd-40ee-97bd-\
312f6604bbda"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"ArcTan", "[", 
    RowBox[{"Tan", "[", 
     RowBox[{"deltaAnalytic", "[", 
      RowBox[{"k", ",", "0.5"}], "]"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.578960298716509*^9, 3.578960307992738*^9}, {
  3.5789891819172897`*^9, 3.578989208233379*^9}, {3.578992542334622*^9, 
  3.578992547944518*^9}, {3.578992585410527*^9, 3.578992593478003*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"de410337-82c2-4609-9e64-99936d303c08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"deltaAnalyticAdjusted", "[", 
   RowBox[{"k_", ",", "V0_"}], "]"}], " ", ":=", " ", 
  RowBox[{"ArcTan", "[", 
   RowBox[{"Tan", "[", 
    RowBox[{"deltaAnalytic", "[", 
     RowBox[{"k", ",", "V0"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.578989241459766*^9, 3.578989265473454*^9}, {
  3.578992635705599*^9, 3.578992652394421*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"6139aff9-c994-43dc-aa38-c74a6d8b64fd"],

Cell[TextData[{
 "We can also avoid this issue by looking at ",
 StyleBox["k Cot[\[Delta](k)] instead, which doesn\[CloseCurlyQuote]t have \
these ambiguities.  ", "InlineFormula"]
}], "Text",
 CellChangeTimes->{{3.578992704481989*^9, 3.578992724905175*^9}, {
  3.578992788977806*^9, 3.578992832971444*^9}, {3.579163368252248*^9, 
  3.579163379703837*^9}},ExpressionUUID->"f06b308e-84b1-4854-8fc3-\
31181ab7bbda"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"k", " ", 
    RowBox[{"Cot", "[", 
     RowBox[{"deltaAnalytic", "[", 
      RowBox[{"k", ",", "0.5"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5789603309180307`*^9, 3.5789603492591*^9}, {
  3.578992692238751*^9, 3.5789926966953993`*^9}, {3.578992778126183*^9, 
  3.578992780765614*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"35515bcd-9d61-455e-9629-ac1e0cd4cdb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phase shift from the Variable Phase Approach", "Section",
 CellChangeTimes->{{3.578992161892858*^9, 3.5789921673167067`*^9}, {
  3.578993425907629*^9, 
  3.578993440455696*^9}},ExpressionUUID->"95cdcb0a-4e89-4bc4-a079-\
7a801bd68c2e"],

Cell[TextData[{
 "Use the formula: ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SuperscriptBox["deltarho", "\[Prime]",
     MultilineFunction->None], 
    RowBox[{"(", "r", ")"}]}], "\[LongEqual]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", "\[Mu]", " ", 
      RowBox[{"Vsw", "(", "r", ")"}], " ", 
      RowBox[{
       SuperscriptBox["sin", "2"], "(", 
       RowBox[{
        RowBox[{"deltarho", "(", "r", ")"}], "+", 
        RowBox[{"k", " ", "r"}]}], ")"}]}], "k"]}]}]],
  CellChangeTimes->{{3.578993663719919*^9, 3.578993697044615*^9}},
  ExpressionUUID->"d37de928-5fb2-4011-83c8-5b2607890819"],
 " with the initial condition that deltarho(0) = 0."
}], "Text",
 CellChangeTimes->{{3.5789937039335747`*^9, 3.578993718524221*^9}, {
  3.579163435683668*^9, 
  3.57916345380762*^9}},ExpressionUUID->"1be3c213-56a8-4554-8936-\
12dfca971c07"],

Cell[TextData[{
 "We\[CloseCurlyQuote]ll need a numerical differential equation solver.  In \
",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " this is NDSolve:"
}], "Text",
 CellChangeTimes->{{3.579163428226066*^9, 3.579163431296524*^9}, {
  3.5791634613447104`*^9, 
  3.579163489245023*^9}},ExpressionUUID->"df519eaf-fd3a-4a3a-bdb7-\
9fd0a8edab82"],

Cell[BoxData[
 RowBox[{
  RowBox[{"?", "NDSolve"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.578960381545372*^9, 3.578960386002426*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"2b537625-1c12-4522-9898-1573e36fdf43"],

Cell["\<\
In principle we integrate out to infinity.  In practice, we choose a value of \
k and integrate out to Rmax, chosen to be well beyond the range of the \
potential (at which point the right side of the equation for deltarho\
\[CloseCurlyQuote](r) is zero), and then evaluate deltarho(Rmax), which is \
the phase shift for momentum k.  Here is an implementation:\
\>", "Text",
 CellChangeTimes->{{3.579163517584667*^9, 
  3.579163674172127*^9}},ExpressionUUID->"14816124-fefa-4c96-a839-\
c45ef778126f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"deltaVPA", "[", 
   RowBox[{"k_", ",", "V0_"}], "]"}], " ", ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rmax", " ", "=", " ", "10"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"integrate", " ", "out", " ", "to", " ", "Rmax"}], ";", " ", 
      RowBox[{
       RowBox[{"just", " ", "need", " ", "Rmax"}], " ", ">", " ", 
       RowBox[{"R", " ", "for", " ", "square", " ", "well"}]}]}], " ", "*)"}], 
    RowBox[{"ans", " ", "=", " ", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"deltarho", "'"}], "[", "r", "]"}], "==", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"1", "/", "k"}], ")"}]}], "2", "\[Mu]", " ", 
           RowBox[{"Vsw", "[", 
            RowBox[{"r", ",", "V0"}], "]"}], " ", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"k", " ", "r"}], " ", "+", " ", 
              RowBox[{"deltarho", "[", "r", "]"}]}], "]"}], "^", "2"}]}]}], 
         ",", 
         RowBox[{
          RowBox[{"deltarho", "[", "0", "]"}], "==", "0"}]}], "}"}], ",", 
       "deltarho", ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "0", ",", "Rmax"}], "}"}], ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "6"}], ",", 
       RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"deltarho", "[", "r", "]"}], " ", "/.", " ", "ans"}], ")"}], 
      "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "/.", " ", 
     RowBox[{"r", "\[Rule]", "Rmax"}]}]}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"evaluate", " ", "at", " ", "r"}], "=", "Rmax"}], " ", "*)"}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.578960634560461*^9, 3.578960651838499*^9}, {
   3.578960688184009*^9, 3.5789607454202414`*^9}, 3.578960790353992*^9, 
   3.5789875055620537`*^9, {3.5789875541816883`*^9, 3.578987594613688*^9}, {
   3.578987838456044*^9, 3.578987844514599*^9}, {3.578993632308796*^9, 
   3.5789936348403063`*^9}, {3.578993758939348*^9, 3.578993792339139*^9}, {
   3.57899392463302*^9, 3.578994092073127*^9}, {3.579163526664806*^9, 
   3.579163536947357*^9}, {3.579163814878038*^9, 3.57916383301299*^9}, {
   3.579163877047821*^9, 3.579163887429225*^9}, {3.579164002318115*^9, 
   3.579164100335245*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"5c808ce2-0844-465e-b4f1-8228d1fe666b"],

Cell["\<\
Do a quick check against the analytic result with sample values for k and V0 \
to see the accuracy we are getting (we use NumberForm to get 10 digits \
displayed):\
\>", "Text",
 CellChangeTimes->{{3.578994130639861*^9, 3.578994156070169*^9}, {
  3.579163685131627*^9, 3.57916369320712*^9}, {3.57916372523689*^9, 
  3.5791637868182*^9}},ExpressionUUID->"841df5d9-b836-4e88-b342-c0e46e4d6853"],

Cell[BoxData[
 RowBox[{"NumberForm", "[", " ", 
  RowBox[{
   RowBox[{"deltaVPA", "[", 
    RowBox[{"2", ",", ".5"}], "]"}], ",", "10"}], "]"}]], "Input",
 CellChangeTimes->{{3.578993988362669*^9, 3.578993991291052*^9}, {
  3.578994096910334*^9, 3.578994099414207*^9}, {3.579163700700739*^9, 
  3.579163742989375*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"4d03cbed-2694-4805-a4e1-991be95c08a3"],

Cell[BoxData[
 RowBox[{"NumberForm", "[", " ", 
  RowBox[{
   RowBox[{"deltaAnalyticAdjusted", "[", 
    RowBox[{"2", ",", ".5"}], "]"}], ",", " ", "10"}], "]"}]], "Input",
 CellChangeTimes->{{3.5789941159829493`*^9, 3.578994121487341*^9}, {
  3.579163747590488*^9, 3.5791637556226683`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"ae91dad3-1537-42c4-a26b-dd99d5052df1"],

Cell["Does it work?  Check a few more values to be sure.", "Text",
 CellChangeTimes->{{3.581534274427188*^9, 
  3.581534285290297*^9}},ExpressionUUID->"1e90f0d8-d4df-4d55-98dc-\
ccf923d7c89b"],

Cell["\<\
To get more digits correct, increase AccuracyGoal and PrecisionGoal (at the \
cost of slower evaluation of the function).\
\>", "Text",
 CellChangeTimes->{{3.57916411510503*^9, 
  3.5791641527125797`*^9}},ExpressionUUID->"574648fe-acc3-40f8-aab9-\
7696de18a8c4"],

Cell["\<\
Check the cutoff phase shift out to Rmax.  Does this plot make sense?\
\>", "Text",
 CellChangeTimes->{{3.578994252430023*^9, 
  3.5789942717884693`*^9}},ExpressionUUID->"f310f314-b9f7-4eb6-a568-\
5a056e4c9a2d"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"deltarho", "[", "r", "]"}], "/.", "ans"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"r", ",", "0", ",", "Rmax"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", " ", "\[Rule]", " ", "Automatic"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.578987615833385*^9, 3.578987630250229*^9}, {
  3.5789879646499357`*^9, 3.57898796923606*^9}, {3.578988061577444*^9, 
  3.5789880925678062`*^9}, {3.578994207373496*^9, 3.578994239800764*^9}, {
  3.803436456653495*^9, 3.8034364711465063`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"61b79edb-8208-4f23-bff0-fce55d341a56"],

Cell["\<\
Now that it seems to be working, try plots of the k Cot[\[Delta]] and \
\[Delta] for two different depths.  How do you explain the results in terms \
of Levinson\[CloseCurlyQuote]s theorem?\
\>", "Text",
 CellChangeTimes->{{3.581534321816457*^9, 
  3.5815343930134153`*^9}},ExpressionUUID->"a1fa051d-ccae-4537-bc6b-\
1c0f09b2e6af"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"V0", " ", "=", " ", "1."}], ";"}], "  "}]], "Input",
 CellChangeTimes->{{3.578994312613879*^9, 3.578994317186401*^9}, {
   3.5789943581195793`*^9, 3.57899436074286*^9}, {3.5789944302582703`*^9, 
   3.578994449520911*^9}, 3.581534300990264*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"42c0afbc-60ad-48c1-8854-f614b9e067cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", " ", 
       RowBox[{"Cot", "[", 
        RowBox[{"deltaAnalytic", "[", 
         RowBox[{"k", ",", "V0"}], "]"}], "]"}]}], ",", 
      RowBox[{"k", " ", 
       RowBox[{"Cot", "[", 
        RowBox[{"deltaVPA", "[", 
         RowBox[{"k", ",", "V0"}], "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "that", " ", "both", " ", "plots", " ", "are", " ", "really",
     " ", 
    RowBox[{"here", "!"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5789603309180307`*^9, 3.5789603492591*^9}, {
  3.578988222315962*^9, 3.578988273229315*^9}, {3.5789942945139303`*^9, 
  3.5789943292765617`*^9}, {3.5789943720400333`*^9, 3.5789943999943*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"8f323d64-9350-4da8-b41c-e0c39ea75544"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"deltaAnalyticAdjusted", "[", 
      RowBox[{"k", ",", "V0"}], "]"}], ",", 
     RowBox[{"deltaVPA", "[", 
      RowBox[{"k", ",", "V0"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0.001", ",", "10"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.578960298716509*^9, 3.578960307992738*^9}, {
  3.5789881350431223`*^9, 3.57898813536278*^9}, {3.578988195975576*^9, 
  3.5789882035373573`*^9}, {3.578989278218079*^9, 3.578989280561844*^9}, {
  3.57899440818211*^9, 3.578994415289714*^9}, {3.5789944632662086`*^9, 
  3.578994468780992*^9}, {3.5791641873534327`*^9, 3.5791641882185698`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"39df83a0-e938-43d8-99ec-0b099cfef9cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"V0", " ", "=", " ", "2."}], ";"}], "  "}]], "Input",
 CellChangeTimes->{{3.578994312613879*^9, 3.578994317186401*^9}, {
   3.5789943581195793`*^9, 3.57899436074286*^9}, {3.5789944302582703`*^9, 
   3.578994449520911*^9}, {3.579165065492917*^9, 3.5791650733668213`*^9}, 
   3.581534306198038*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"5da79fde-ca1c-4624-8114-4d29563e6eed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", " ", 
       RowBox[{"Cot", "[", 
        RowBox[{"deltaAnalytic", "[", 
         RowBox[{"k", ",", "V0"}], "]"}], "]"}]}], ",", 
      RowBox[{"k", " ", 
       RowBox[{"Cot", "[", 
        RowBox[{"deltaVPA", "[", 
         RowBox[{"k", ",", "V0"}], "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "that", " ", "both", " ", "plots", " ", "are", " ", "really",
     " ", 
    RowBox[{"here", "!"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5789603309180307`*^9, 3.5789603492591*^9}, {
  3.578988222315962*^9, 3.578988273229315*^9}, {3.5789942945139303`*^9, 
  3.5789943292765617`*^9}, {3.5789943720400333`*^9, 3.5789943999943*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"4e42bf30-5f39-4bed-b302-c6373bbea039"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"deltaAnalyticAdjusted", "[", 
      RowBox[{"k", ",", "V0"}], "]"}], ",", 
     RowBox[{"deltaVPA", "[", 
      RowBox[{"k", ",", "V0"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0.001", ",", "10"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.578960298716509*^9, 3.578960307992738*^9}, {
  3.5789881350431223`*^9, 3.57898813536278*^9}, {3.578988195975576*^9, 
  3.5789882035373573`*^9}, {3.578989278218079*^9, 3.578989280561844*^9}, {
  3.57899440818211*^9, 3.578994415289714*^9}, {3.5789944632662086`*^9, 
  3.578994468780992*^9}, {3.5791641873534327`*^9, 3.5791641882185698`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"cda635eb-78cb-4cb8-b1ab-6886979ffd47"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Now it\[CloseCurlyQuote]s time to play!", "Section",
 CellChangeTimes->{{3.578992161892858*^9, 3.5789921673167067`*^9}, {
  3.578993425907629*^9, 3.578993440455696*^9}, {3.578994504664263*^9, 
  3.5789945085398197`*^9}},ExpressionUUID->"628b6bd8-aa3c-4ace-aa8c-\
ecf9a82fa135"],

Cell["\<\
Check whether Levinson\[CloseCurlyQuote]s theorem holds by calculating phase \
shifts for increasing depths V0 and noting the jump to \[Delta](0) = n\[Pi], \
where n is the number of bound states (found, for example, from the \
square_well_example.nb notebook).\
\>", "Text",
 CellChangeTimes->{{3.578996224192925*^9, 
  3.578996340835588*^9}},ExpressionUUID->"68f2b707-2108-46cd-bf62-\
5033f45104fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"deltaVPA", "[", 
        RowBox[{"k", ",", "V0"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0.001", ",", "20"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"V0", ",", 
      RowBox[{"{", 
       RowBox[{
       "0.5", ",", "1.0", ",", "2.0", ",", "5.0", ",", "10.0", ",", "20.0"}], 
       "}"}]}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Try", " ", "for", " ", "V0"}], " ", "=", " ", 
    RowBox[{"0.5", " ", "to", " ", "20"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.578989345329733*^9, 3.578989375653373*^9}, {
   3.5789904565047407`*^9, 3.578990461264996*^9}, {3.57899050577595*^9, 
   3.578990506558255*^9}, {3.578990635597796*^9, 3.578990642088243*^9}, {
   3.5789910962934027`*^9, 3.578991105518475*^9}, {3.578991210019278*^9, 
   3.57899121083936*^9}, {3.578994485451626*^9, 3.578994486258993*^9}, {
   3.578994536843831*^9, 3.578994537998517*^9}, 3.578994610299131*^9, {
   3.5789963742939796`*^9, 3.5789963880193233`*^9}, {3.579164234749921*^9, 
   3.5791642355699863`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"ee9f028f-556a-47c8-b74d-a54176845747"],

Cell["\<\
Does it work?  [Note: we start at k=0.001 to avoid numerical issues at k=0.]\
\>", "Text",
 CellChangeTimes->{{3.5791642649774733`*^9, 3.5791643113373957`*^9}, {
   3.581534407524272*^9, 3.581534413270306*^9}, 
   3.619253283960861*^9},ExpressionUUID->"07236427-1b75-40e7-85cb-\
ff5f8eb1974c"],

Cell["This is really fun using Manipulate!  ", "Text",
 CellChangeTimes->{{3.578996421170898*^9, 3.578996446485091*^9}, 
   3.5791651071729927`*^9},ExpressionUUID->"b88b6dfd-e0b7-4b93-ba99-\
b96170d64029"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"deltaVPA", "[", 
      RowBox[{"k", ",", "V0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0.001", ",", "10"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"V0", ",", "0", ",", "20", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.578990358174251*^9, 3.5789904120415163`*^9}, {
  3.5789905646838207`*^9, 3.5789905648489017`*^9}, {3.5789963973383408`*^9, 
  3.5789963993614264`*^9}, {3.5789964349304*^9, 3.578996435041732*^9}, {
  3.578996809557146*^9, 3.5789968099827414`*^9}, {3.578996893651107*^9, 
  3.5789968960572968`*^9}, {3.578996929122736*^9, 3.5789969339496098`*^9}, {
  3.579164834284719*^9, 3.579164834800334*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"d039a014-51ee-45d4-bd93-059a6b35962b"]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{695.25, 762.},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
ShowSelection->True,
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.25, 1.25 Inherited],
FrontEndVersion->"12.1 for Linux x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3715e1a6-d51d-4be3-bd4b-5302f233d69e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 260, 4, 176, "Subtitle",ExpressionUUID->"0f2b73d7-1789-450c-b37a-11c5f36982fc"],
Cell[CellGroupData[{
Cell[707, 23, 211, 4, 83, "Section",ExpressionUUID->"e4f60c0f-18fd-4860-b031-e4b10c42ac1c"],
Cell[921, 29, 350, 7, 101, "Text",ExpressionUUID->"c6cfd9f4-0fec-4f5f-9607-1896a38c4dae"],
Cell[1274, 38, 346, 7, 101, "Text",ExpressionUUID->"030600d9-350e-4282-a0b3-c7f1e0abeb2f"],
Cell[1623, 47, 461, 8, 36, "Input",ExpressionUUID->"f9bd32a8-9d75-4edf-8342-444907931f5f"],
Cell[2087, 57, 191, 3, 43, "Text",ExpressionUUID->"9640d5cd-e40c-4bcf-9357-956833a9214f"],
Cell[2281, 62, 611, 14, 62, "Input",ExpressionUUID->"152dc746-d8a8-42a1-a3bf-6b0418633a92"],
Cell[2895, 78, 668, 15, 62, "Input",ExpressionUUID->"65388054-f72b-44b0-9a58-b8de24e1608b"],
Cell[3566, 95, 574, 14, 62, "Input",ExpressionUUID->"b09e17e1-8761-431f-b7aa-73b58416000c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4177, 114, 182, 3, 83, "Section",ExpressionUUID->"fb51d75e-a512-41f2-8c52-fab6ad85fe71"],
Cell[4362, 119, 302, 7, 72, "Text",ExpressionUUID->"763f5ee2-bc77-48cb-961e-42581e01bc16"],
Cell[4667, 128, 1052, 28, 88, "Input",ExpressionUUID->"07f7602f-044d-4f91-b793-a7a03262485f"],
Cell[5722, 158, 1389, 38, 148, "Text",ExpressionUUID->"bb004ca7-c445-4630-a22a-78a55657405b"],
Cell[7114, 198, 200, 3, 43, "Text",ExpressionUUID->"f86a06c7-17c0-4357-a700-2bae4f5cac10"],
Cell[7317, 203, 337, 6, 36, "Input",ExpressionUUID->"e25cbfe7-ec3f-4d95-b5b2-674205f715cb"],
Cell[7657, 211, 454, 10, 36, "Input",ExpressionUUID->"6a33db37-a692-4957-94a4-83a0b2191795"],
Cell[8114, 223, 270, 6, 72, "Text",ExpressionUUID->"d76f4987-d012-40e5-8665-31012bd093a1"],
Cell[8387, 231, 346, 7, 101, "Text",ExpressionUUID->"f376493a-05bd-40ee-97bd-312f6604bbda"],
Cell[8736, 240, 569, 12, 36, "Input",ExpressionUUID->"de410337-82c2-4609-9e64-99936d303c08"],
Cell[9308, 254, 462, 10, 62, "Input",ExpressionUUID->"6139aff9-c994-43dc-aa38-c74a6d8b64fd"],
Cell[9773, 266, 413, 8, 74, "Text",ExpressionUUID->"f06b308e-84b1-4854-8fc3-31181ab7bbda"],
Cell[10189, 276, 513, 12, 36, "Input",ExpressionUUID->"35515bcd-9d61-455e-9629-ac1e0cd4cdb1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10739, 293, 240, 4, 131, "Section",ExpressionUUID->"95cdcb0a-4e89-4bc4-a079-7a801bd68c2e"],
Cell[10982, 299, 859, 24, 79, "Text",ExpressionUUID->"1be3c213-56a8-4554-8936-12dfca971c07"],
Cell[11844, 325, 355, 10, 72, "Text",ExpressionUUID->"df519eaf-fd3a-4a3a-bdb7-9fd0a8edab82"],
Cell[12202, 337, 231, 4, 62, "Input",ExpressionUUID->"2b537625-1c12-4522-9898-1573e36fdf43"],
Cell[12436, 343, 510, 9, 158, "Text",ExpressionUUID->"14816124-fefa-4c96-a839-c45ef778126f"],
Cell[12949, 354, 2592, 62, 315, "Input",ExpressionUUID->"5c808ce2-0844-465e-b4f1-8228d1fe666b"],
Cell[15544, 418, 402, 7, 101, "Text",ExpressionUUID->"841df5d9-b836-4e88-b342-c0e46e4d6853"],
Cell[15949, 427, 397, 8, 36, "Input",ExpressionUUID->"4d03cbed-2694-4805-a4e1-991be95c08a3"],
Cell[16349, 437, 370, 7, 36, "Input",ExpressionUUID->"ae91dad3-1537-42c4-a26b-dd99d5052df1"],
Cell[16722, 446, 192, 3, 43, "Text",ExpressionUUID->"1e90f0d8-d4df-4d55-98dc-ccf923d7c89b"],
Cell[16917, 451, 272, 6, 72, "Text",ExpressionUUID->"574648fe-acc3-40f8-aab9-7696de18a8c4"],
Cell[17192, 459, 221, 5, 43, "Text",ExpressionUUID->"f310f314-b9f7-4eb6-a568-5a056e4c9a2d"],
Cell[17416, 466, 660, 14, 62, "Input",ExpressionUUID->"61b79edb-8208-4f23-bff0-fce55d341a56"],
Cell[18079, 482, 341, 7, 101, "Text",ExpressionUUID->"a1fa051d-ccae-4537-bc6b-1c0f09b2e6af"],
Cell[18423, 491, 369, 7, 36, "Input",ExpressionUUID->"42c0afbc-60ad-48c1-8854-f614b9e067cb"],
Cell[18795, 500, 998, 25, 88, "Input",ExpressionUUID->"8f323d64-9350-4da8-b41c-e0c39ea75544"],
Cell[19796, 527, 830, 17, 62, "Input",ExpressionUUID->"39df83a0-e938-43d8-99ec-0b099cfef9cf"],
Cell[20629, 546, 421, 8, 36, "Input",ExpressionUUID->"5da79fde-ca1c-4624-8114-4d29563e6eed"],
Cell[21053, 556, 998, 25, 88, "Input",ExpressionUUID->"4e42bf30-5f39-4bed-b302-c6373bbea039"],
Cell[22054, 583, 830, 17, 62, "Input",ExpressionUUID->"cda635eb-78cb-4cb8-b1ab-6886979ffd47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22921, 605, 283, 4, 83, "Section",ExpressionUUID->"628b6bd8-aa3c-4ace-aa8c-ecf9a82fa135"],
Cell[23207, 611, 411, 8, 130, "Text",ExpressionUUID->"68f2b707-2108-46cd-bf62-5033f45104fc"],
Cell[23621, 621, 1327, 30, 88, "Input",ExpressionUUID->"ee9f028f-556a-47c8-b74d-a54176845747"],
Cell[24951, 653, 303, 6, 72, "Text",ExpressionUUID->"07236427-1b75-40e7-85cb-ff5f8eb1974c"],
Cell[25257, 661, 205, 3, 43, "Text",ExpressionUUID->"b88b6dfd-e0b7-4b93-ba99-b96170d64029"],
Cell[25465, 666, 955, 20, 62, "Input",ExpressionUUID->"d039a014-51ee-45d4-bd93-059a6b35962b"]
}, Open  ]]
}, Open  ]]
}
]
*)

